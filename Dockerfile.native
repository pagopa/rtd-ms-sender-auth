FROM ghcr.io/graalvm/native-image:ol8-java17-22@sha256:3210af2c1bdf6a73cd82092909e5ed4674ef09caa1b32f2b05db7f232aba72f2 AS builder

WORKDIR /build
COPY . .

RUN ./mvnw clean package -Pnative -DskipTests

FROM ubuntu:lunar-20230128@sha256:52293638ba652a2e8f9e1c1cfcc905839b1f2a9e671ddcc9bf77909b6bf527d0 as runtime

EXPOSE 8080

COPY --from=builder /build/target/rtd-ms-sender-auth .

ENTRYPOINT ["./rtd-ms-sender-auth"]